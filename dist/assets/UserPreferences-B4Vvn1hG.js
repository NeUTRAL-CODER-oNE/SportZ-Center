import{r as c,T,u as S,a as C,b as $,j as e,q as p,_ as d,A as u}from"./index-BekuKahj.js";const z=()=>{const{theme:l}=c.useContext(T),m=S(),[g,f]=c.useState(!1),j=C(),{teams:y}=j,b=$(),{sports:N}=b,[o,x]=c.useState({sports:[],teams:[]});console.log(o);const h=(s,t)=>{const{value:a,checked:n}=s.target;x(r=>{const i=Array.isArray(r[t])?r[t]:[];return n?{...r,[t]:[...i,a]}:{...r,[t]:i.filter(k=>k!==a)}})};c.useEffect(()=>{(async()=>{const t=localStorage.getItem("authToken");try{const n=await(await fetch(`${u}/user/preferences`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}})).json();console.log(n);const r=n.preferences||{sports:[],teams:[]};x(r)}catch(a){console.log("Error fetching preferences:",a)}})()},[]);const w=async()=>{try{const s=localStorage.getItem("authToken");if(console.log(s),!s)throw new Error("User is not authenticated");const t=await fetch(`${u}/user/preferences`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({preferences:o})});if(!t.ok){const r=await t.text();throw new Error(`Failed to update preferences: ${t.status} - ${r}`)}const a=await t.json();console.log(a);const n=localStorage.getItem("userData");if(n){const i={...JSON.parse(n),preferences:a.preferences};console.log("Updated user data:",i),localStorage.setItem("userData",JSON.stringify(i))}m("/"),window.location.reload()}catch(s){console.error("Error updating preferences:",s),alert("Failed to update preferences. Please try again later.")}};c.useEffect(()=>{f(!0)},[]);const v=()=>{f(!1),m("../..")};return e.jsx(e.Fragment,{children:e.jsx(p,{appear:!0,show:g,as:c.Fragment,children:e.jsx(d,{as:"div",className:"fixed inset-0 z-50 overflow-y-3xl flex justify-center  bg-black bg-opacity-25",onClose:v,children:e.jsx("div",{className:"flex items-center justify-center max-h-screen",children:e.jsx(p.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(d.Panel,{className:`mx-auto m-auto p-10 w-full max-w-3xl transform overflow-hidden rounded-2xl align-middle shadow-xl transition-all ${l==="dark"?"bg-gray-900":"bg-white"}`,children:[e.jsx(d.Title,{className:`flex justify-center text-2xl font-mono font-bold ${l==="dark"?"text-white":"text-gray-900"}`,children:"Preferences"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-mono font-bold ${l==="dark"?"text-zinc-200":"text-gray-700"}`,children:"Sports"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 sm:grid-cols-2 gap-1 mt-4",children:N.map(s=>{var t;return e.jsxs("div",{className:"flex items-center mb-2 accent-blue-700",children:[e.jsx("input",{className:"mr-2",onChange:a=>h(a,"sports"),type:"checkbox",value:s.name,checked:((t=o==null?void 0:o.sports)==null?void 0:t.includes(s.name))||!1}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-500",children:s.name})]},s.id)})}),e.jsx("br",{})]}),e.jsxs("div",{children:[e.jsx("p",{className:`font-mono font-bold ${l==="dark"?"text-zinc-200":"text-gray-700"}`,children:"Teams"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 sm:grid-cols-2 gap-1 mt-4",children:y.map(s=>{var t;return e.jsxs("div",{className:"flex items-center mb-2 accent-blue-700",children:[e.jsx("input",{className:"mr-2",onChange:a=>h(a,"teams"),type:"checkbox",value:s.name,name:s.name,checked:((t=o==null?void 0:o.teams)==null?void 0:t.includes(s.name))||!1}),e.jsx("p",{className:"text-sm font-mono font-bold text-zinc-500",children:s.name})]},s.id)})})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx("button",{onClick:w,className:` text-zinc-500 font-mono font-bold px-4 py-2 ${l==="dark"?"bg-gray-800  hover:bg-gray-700":"bg-gray-200 hover:bg-gray-300"} rounded-md`,children:"Apply Preference"})})]})})})})})})};export{z as default};
